<app-header-admin></app-header-admin>

<div class="usuarios-container">
  <p class="breadcrumb-title">GESTI√ìN DE USUARIOS</p>
  <h1 class="section-title">Edici√≥n/Eliminaci√≥n de Usuarios</h1>

  <!-- ‚è≥ Loading indicator -->
  @if (loading) {
    <div class="loading-container">
      <p>Cargando usuarios...</p>
    </div>
  }

  <!-- ‚ùå Error message -->
  @if (error && !loading) {
    <div class="error-container">
      <p>{{ error }}</p>
      <button (click)="recargarLista()">Reintentar</button>
    </div>
  }

  <!-- üìä Tabla de usuarios -->
  @if (!loading && !error) {
    <div class="usuarios-table-container">
      <table mat-table [dataSource]="usuarios" class="usuarios-table">
        
        <!-- Nombres -->
        <ng-container matColumnDef="nombres">
          <th mat-header-cell *matHeaderCellDef>Nombres</th>
          <td mat-cell *matCellDef="let usuario">{{ usuario.nombres }}</td>
        </ng-container>

        <!-- Apellidos -->
        <ng-container matColumnDef="apellidos">
          <th mat-header-cell *matHeaderCellDef>Apellidos</th>
          <td mat-cell *matCellDef="let usuario">{{ usuario.apellidos }}</td>
        </ng-container>

        <!-- Username -->
        <ng-container matColumnDef="username">
          <th mat-header-cell *matHeaderCellDef>Usuario</th>
          <td mat-cell *matCellDef="let usuario">{{ usuario.username }}</td>
        </ng-container>

        <!-- Email -->
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef>Correo</th>
          <td mat-cell *matCellDef="let usuario">{{ usuario.email }}</td>
        </ng-container>

        <!-- Roles -->
        <ng-container matColumnDef="roles">
          <th mat-header-cell *matHeaderCellDef>Rol</th>
          <td mat-cell *matCellDef="let usuario">{{ usuario.roles }}</td>
        </ng-container>

        <!-- Estado -->
        <ng-container matColumnDef="estado">
          <th mat-header-cell *matHeaderCellDef>Estado</th>
          <td mat-cell *matCellDef="let usuario">
            @if (usuario.is_active) {
              <span>Activo</span>
            } @else {
              <span>Inactivo</span>
            }
          </td>
        </ng-container>

        <!-- Acciones -->
        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef>Acciones</th>
          <td mat-cell *matCellDef="let usuario">
            <!-- Icono de editar -->
            <img
              src="assets/admin/ADMIN_7.png"
              alt="Editar"
              class="action-icon"
              (click)="editarUsuario(usuario)"
            />
            <!-- Icono de eliminar -->
            <img
              src="assets/admin/ADMIN_7_1.png"
              alt="Eliminar"
              class="action-icon"
              (click)="abrirDialogoEliminar(usuario)"
            />
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>
  }

  <!-- üì≠ Empty state -->
  @if (!loading && !error && usuarios.length === 0) {
    <div class="empty-state">
      <p>No hay usuarios registrados</p>
    </div>
  }
</div>

<app-footer-admin [backRoute]="'/administrador/gestion-usuarios'"></app-footer-admin>